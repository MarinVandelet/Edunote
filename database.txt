CREATE DATABASE IF NOT EXISTS Edunote;
USE Edunote;

-- Création de la table CLASSE
CREATE TABLE CLASSE (
    ID_classe INT PRIMARY KEY,
    nom VARCHAR(255)
);

-- Création de la table ADMINISTRATEUR
CREATE TABLE ADMINISTRATEUR(
    ID_admin VARCHAR(255) PRIMARY KEY,
    nom VARCHAR(255),
    prenom VARCHAR(255),
    adresse_mail VARCHAR(255),
    password VARCHAR(255)
);

-- Création de la table UE
CREATE TABLE UE (
    ID_UE VARCHAR(255) PRIMARY KEY,
    Competence VARCHAR(255)
);

-- Création de la table TYPE_ENSEIGNEMENT
CREATE TABLE TYPE_ENSEIGNEMENT(
    type VARCHAR(255) PRIMARY KEY
);

-- Création de la table ENSEIGNEMENT
CREATE TABLE ENSEIGNEMENT (
    ID_Ens VARCHAR(255) PRIMARY KEY,
    nom_Ens VARCHAR(255),
    Semestre INT,
    Coefficient INT,
    ID_UE VARCHAR(255),
    type VARCHAR(255),
    FOREIGN KEY (ID_UE) REFERENCES UE(ID_UE),
    FOREIGN KEY (type) REFERENCES TYPE_ENSEIGNEMENT(type)
);

-- Création de la table ENSEIGNANT
CREATE TABLE ENSEIGNANT (
    ID_prof VARCHAR(255) PRIMARY KEY,
    nom VARCHAR(255),
    prenom VARCHAR(255),
    adresse_mail VARCHAR(255),
    password VARCHAR(255)
);

-- Création de la table ELEVE
CREATE TABLE ELEVE (
    ID_eleve VARCHAR(255) PRIMARY KEY,
    password VARCHAR(255),
    nom VARCHAR(255),
    prenom VARCHAR(255),
    adresse_mail VARCHAR(255),
    ID_classe INT,
    FOREIGN KEY (ID_classe) REFERENCES CLASSE(ID_classe)
);

-- Création de la table EPREUVE
CREATE TABLE EPREUVE (
    ID_epreuve INT PRIMARY KEY AUTO_INCREMENT, 
    Date_epreuve DATE, 
    Nom_epreuve VARCHAR(255), 
    type VARCHAR(255), 
    note INT, 
    coef_note INT, 
    ID_enseignement VARCHAR(255), 
    ID_eleve VARCHAR(255),
    ID_classe INT,
    ID_prof VARCHAR(255), 
    FOREIGN KEY (ID_enseignement) REFERENCES ENSEIGNEMENT(ID_Ens),
    FOREIGN KEY (ID_eleve) REFERENCES ELEVE(ID_eleve), 
    FOREIGN KEY (ID_classe) REFERENCES CLASSE(ID_classe),
    FOREIGN KEY (ID_prof) REFERENCES ENSEIGNANT(ID_prof),
    FOREIGN KEY (type) REFERENCES TYPE_ENSEIGNEMENT(type)
);

-- Création de la table ENSEIGNE
CREATE TABLE ENSEIGNE (
    ID_prof VARCHAR(255),
    ID_Ens VARCHAR(255),
    PRIMARY KEY (ID_prof, ID_Ens),
    FOREIGN KEY (ID_prof) REFERENCES ENSEIGNANT(ID_prof),
    FOREIGN KEY (ID_Ens) REFERENCES ENSEIGNEMENT(ID_Ens)
);

-- Création de la table CONTIENT
CREATE TABLE CONTIENT (
    ID_UE VARCHAR(255),
    ID_Ens VARCHAR(255),
    PRIMARY KEY (ID_UE, ID_Ens),
    FOREIGN KEY (ID_UE) REFERENCES UE(ID_UE),
    FOREIGN KEY (ID_Ens) REFERENCES ENSEIGNEMENT(ID_Ens)
);

-- Insertion d'une classe
INSERT INTO CLASSE (ID_classe, nom)
VALUES (2, 'TD1');

-- Insertion d'un administrateur
INSERT INTO ADMINISTRATEUR (ID_admin, nom, prenom, adresse_mail, password)
VALUES ('12345', 'Martin', 'Paul', 'administrateur@exemple.com','$2b$12$xEpU9B4dSarUrQXjZCWwSOgdm8PBzpTZjT2ihDeSTfWVg7nPTiKaq');

-- Insertion d'un élève
INSERT INTO ELEVE (ID_eleve, password, nom, prenom, adresse_mail, ID_classe)
VALUES ('123456', '$2b$12$xEpU9B4dSarUrQXjZCWwSOgdm8PBzpTZjT2ihDeSTfWVg7nPTiKaq', 'Dupont', 'Jean', 'jean.dupont@exemple.com', 2);

-- Insertion d'un prof
INSERT INTO ENSEIGNANT(ID_prof, nom, prenom, password, adresse_mail) 
VALUES ('25','Toryan','Dissier','$2b$12$xEpU9B4dSarUrQXjZCWwSOgdm8PBzpTZjT2ihDeSTfWVg7nPTiKaq','toryan@exemple.com');
VALUES ('24','Clement','Sigalas','$2b$12$xEpU9B4dSarUrQXjZCWwSOgdm8PBzpTZjT2ihDeSTfWVg7nPTiKaq','prof@exemple.com');

-- Insertion des types d'épreuve
INSERT INTO TYPE_ENSEIGNEMENT (type) VALUES ('SAE');
INSERT INTO TYPE_ENSEIGNEMENT (type) VALUES ('Ressource');
INSERT INTO TYPE_ENSEIGNEMENT (type) VALUES ('Autre');

-- Insertion des UE
INSERT INTO UE (ID_UE, Competence) VALUES
('1', 'Comprendre'),
('2', 'Intérragir');

-- Insertion des enseignements
INSERT INTO ENSEIGNEMENT (ID_Ens, nom_Ens, Semestre, Coefficient, ID_UE, type) VALUES
('666372c2e0618', 'Culture Artistique', 2, 2, '1', 'Autre'),
('666376efe324c', 'Numérique', 1, 1, '1', 'Ressource');

-- Insertion de la liaison entre l'enseignant et l'enseignement
INSERT INTO ENSEIGNE (ID_prof, ID_Ens) VALUES ('25', '666372c2e0618');
